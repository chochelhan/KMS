"use strict";(self["webpackChunkkms"]=self["webpackChunkkms"]||[]).push([[7216],{7216:function(t,a,e){e.r(a),e.d(a,{default:function(){return _}});var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"search-container-layout"},[e("div",{staticClass:"search-container"},[t.keywordResult?e("div",{staticClass:"result-keyword-box"},[e("div",{staticClass:"keyword-text"},[e("span",[t._v('"'+t._s(t.keywordResult)+'"')]),t._v("에 대한 통합 검색결과가 "),e("br",{staticClass:"tablet-mobile-element"}),t._v("총 "),e("span",[t._v(t._s(t.totalCount)+"건")]),t._v(" 조회되었습니다 ")]),e("v-btn",{staticClass:"blackButton",on:{click:function(a){return t.totalSearchOpen()}}},[e("span",[t._v("상세검색")])])],1):t._e(),e("div",{staticClass:"article-total-box"},[e("ul",{staticClass:"tab"},[e("li",{class:t.totalActive,on:{click:function(a){return t.setTab("total")}}},[t._v("통합검색 ("+t._s(t.totalCount)+")")]),t._l(t.tabList,(function(a){return e("li",{class:a.active,on:{click:function(e){return t.setTab(a.code)}}},[t._v(" "+t._s(a.name)+" ("+t._s(t.util.numberFormat(a.data.total))+") ")])}))],2),e("ul",{staticClass:"board-container"},t._l(t.tabList,(function(a,s){return e("li",{staticClass:"board-item",attrs:{id:"tab-article-list-"+a.code}},[e("div",{staticClass:"board-name"},[t._v(" "+t._s(a.name)+" ("+t._s(t.util.numberFormat(a.data.total))+"건) ")]),a.data.list.length>0?e("div",{staticClass:"list-bottom-line"},[e("ul",{class:"article-container "+a.code},t._l(a.data.list,(function(s,i){return e("li",{on:{click:function(a){return t.articleView(s)}}},["img"!=a.code?e("div",{staticClass:"article-data"},["article"==a.code?e("div",{staticClass:"subject"},["no"==s.open?e("span",[e("font-awesome-icon",{staticStyle:{"font-size":"12px",color:"#666"},attrs:{icon:"fa-solid fa-lock"}})],1):t._e(),e("div",{staticClass:"subject-value",domProps:{innerHTML:t._s(s.subject)}})]):t._e(),"file"!=a.code?e("div",{staticClass:"desc",domProps:{innerHTML:t._s(s.content)}}):t._e(),"article"==a.code&&s.keywords?e("div",{staticClass:"keyword",domProps:{innerHTML:t._s(s.keywords)}}):t._e(),"file"==a.code?e("div",{staticClass:"file"},[t._v(" "+t._s(s.fileName)+" ")]):t._e(),e("div",{staticClass:"author"},[t._v(" 작성자"),e("span",{staticClass:"text"},[t._v(t._s(s.userName))]),t._v(" 작성일자"),e("span",{staticClass:"text"},[t._v(t._s(s.createAt.replace("T"," ").substring(1,16)))]),"comment"!=a.code?e("span",{staticClass:"pc-tablet-element"},[t._v("조회수"),e("span",{staticClass:"text"},[t._v(t._s(s.hit))])]):t._e()])]):"img"==a.code?e("div",{staticClass:"article-data"},[s.imgUrl?e("div",{staticClass:"img"},[e("img",{attrs:{src:s.imgUrl}})]):t._e(),e("div",{staticClass:"img-name"},[t._v(t._s(s.imgName))]),e("div",{staticClass:"author"},[t._v(" 작성자"),e("span",{staticClass:"text"},[t._v(t._s(s.userName))])])]):t._e()])})),0),e("paging",{attrs:{paging:a.data.paging,scrollNone:"yes",addPrams:{code:a.code},reload:a.data.pagingReload},on:{pageMove:t.pageBoardMode}})],1):e("div",{staticClass:"no-data"},[t._v(" 검색 결과가 없습니다 ")])])})),0)]),e("articleUpassComponent",{attrs:{bid:t.bid,articleId:t.articleId,modelOpen:t.passDialogShow},on:{upassSuccess:t.viewSuccess,parentOpenFalse:function(a){t.passDialogShow=!1}}}),e("v-dialog",{staticStyle:{"z-index":"100"},attrs:{width:"1300",persistent:"",rounded:""},model:{value:t.searchDialog,callback:function(a){t.searchDialog=a},expression:"searchDialog"}},[e("div",{staticClass:"modal-layout",staticStyle:{height:"800px",background:"#fff"}},[e("div",{staticClass:"modal-header"},[e("div",{staticClass:"modal-title"}),e("div",{staticClass:"modal-close",on:{click:function(a){t.searchDialog=!1}}},[e("font-awesome-icon",{attrs:{icon:"fa-solid fa-circle-xmark"}})],1)]),e("div",{staticClass:"modal-body",attrs:{id:"articleView-container"}},[t.searchDialog?e("searchComponent",{attrs:{keyword:t.keyword}}):t._e()],1)])])],1)])},i=[],o=e(9248),l=e(5494),r=e(3699),d=e(1122),c=e(6965),n=e(629),h=e(5158),g=e(7590),m=e(9755),u=e.n(m),p={name:"mainSearch",components:{articleUpassComponent:c.Z,searchComponent:h.Z,paging:g.Z},computed:{...(0,n.Se)("config",["getMenu","getSettingActive"])},watch:{getSettingActive(t){t&&this.getMcode()},searchDialog(t){t?u()("body").css("position","fixed"):u()("body").css("position","static")}},data(){return{util:d.Z,keyword:"",memberInfo:{},passDialogShow:!1,keywordResult:"",tabCode:"total",bid:"",searchDialog:!1,articleId:"",totalActive:"active",totalCount:0,tabList:[{name:"문서",code:"article",active:"",data:{total:0,list:[],page:1,paging:{},pagingReload:!1}},{name:"댓글",code:"comment",active:"",data:{total:0,list:[],page:1,paging:{},pagingReload:!1}},{name:"이미지",code:"img",active:"",data:{total:0,list:[],page:1,paging:{},pagingReload:!1}},{name:"파일",code:"file",active:"",data:{total:0,list:[],page:1,paging:{},pagingReload:!1}}],limit:10,page:1,total:0,paging:{},pagingReload:!1,boardIds:{}}},created(){this.$eventBus.$on("searchKeyword",this.eventSearch),this.keyword=this.$route.params.keyword;const t=r.Z.getSession();t&&t.memberInfo&&(this.memberInfo=t.memberInfo),this.getSettingActive&&this.getMcode(),this.search()},methods:{setTab(t){"total"==t?(this.tabCode="total",this.totalActive="active",u()(".board-container .board-item").show()):(this.totalActive="",u()(".board-container .board-item").hide()),this.tabList.forEach((a=>{a.code==t?(a.active="active",this.tabCode=t,u()("#tab-article-list-"+t).show()):a.active=""}))},getMcode(){for(let t of this.getMenu)if("yes"==t.muse)if(t.subList&&t.subList.length>0)for(let a of t.subList)"yes"==a.muse&&"board"==a.linkType&&(this.boardIds[a.boardId]={mainCode:t.code,subCode:a.code});else"board"==t.linkType&&(this.boardIds[t.boardId]={mainCode:t.code})},totalSearchOpen(){this.searchDialog=!0},eventSearch(t){this.keyword=t.keyword,this.$router.push("/search/"+this.keyword).catch((()=>{})),this.search()},search(){if(!this.keyword)return;let t=[];for(const e in this.boardIds)t.push(e);let a={keyword:this.keyword,searchBids:t,limit:this.limit.toString()};this.$eventBus.$emit("overlay","open"),this.tabList[0].data.page=1,this.tabList[1].data.page=1,this.tabList[2].data.page=1,this.tabList[3].data.page=1,this.page=1,this.serverFlag=!0,this.setTab("total"),o.Z.post(l.uk,a,(t=>{this.keywordResult=this.keyword,this.$eventBus.$emit("overlay","hide"),this.serverFlag=!1,"success"==t.status&&this.setAllDataList(t,"all")}))},setAllDataList(t,a,e){let s=0,i=0;for(let l of this.tabList){if("all"==a){switch(l.code){case"article":l.data.total=t.articleData.total,l.data.list=[];for(let a of t.articleData.list){if(a.content=d.Z.stripTagsNotEm(a.content),a.keywords){let t=a.keywords.split(","),e=[];for(let a of t)-1!==a.indexOf(this.keyword)&&e.push(a.replace(a,"<em>"+this.keyword+"</em>"));e.length>0&&(a.keywords="#"+e.join(", #"))}l.data.list.push(a)}l.data.paging={total:t.articleData.total,currentPage:l.data.page,limit:this.limit,pageGroup:10};break;case"comment":l.data.total=t.commentData.total,l.data.list=t.commentData.list,l.data.paging={total:t.commentData.total,currentPage:l.data.page,limit:this.limit,pageGroup:10};break;case"img":l.data.total=t.articleImageData.total,l.data.list=[];for(let a of t.articleImageData.list){if(a.imgs){let t=a.imgs.split(","),e=a.orgImgNames.split(","),s=a.searchImgNames.split(","),i="",l="",r=0;for(let a of s)-1===a.indexOf(this.keywordResult)||i||(i=t[r],l=e[r]),r++;a.imgUrl=o.Z.imgHost+"api/controller/board/getArticleImage?imgName="+encodeURIComponent(i),a.imgName=l}l.data.list.push(a)}l.data.paging={total:t.articleImageData.total,currentPage:l.data.page,limit:this.limit,pageGroup:10};break;case"file":l.data.total=t.articleFileData.total,l.data.list=[];for(let a of t.articleFileData.list){if(a.dfileOrgNames){let t=a.dfileOrgNames.split(","),e="";for(let a of t)-1===a.indexOf(this.keywordResult)||e||(e=a);a.fileName=e}l.data.list.push(a)}l.data.paging={total:t.articleFileData.total,currentPage:l.data.page,limit:this.limit,pageGroup:10};break}l.data.pagingReload=!0;const a=i;setTimeout((()=>{l.data.pagingReload=!1,this.$set(this.tabList,a,l)}),500),s+=parseInt(l.data.total)}else if(l.code==a){l.data.total=t.resultData.total,l.data.list=t.resultData.list,l.data.paging={total:t.resultData.total,currentPage:e,limit:this.limit,pageGroup:10},l.data.pagingReload=!0;const a=i;setTimeout((()=>{l.data.pagingReload=!1,this.$set(this.tabList,a,l)}),500),this.$set(this.tabList,i,l)}i++}this.totalCount=d.Z.numberFormat(s)},articleView(t){let a=!1;if(t.subject){if("no"==t.open)if("ROLE_ADMIN"==this.memberInfo.role)a=!0;else{if(!t.userId)return this.articleId=t.id,this.bid=t.bid,void(this.passDialogShow=!0);t.userId==this.memberInfo.uid&&(a=!0)}else a=!0;if(a){this.page,this.category;if(this.boardIds[t.bid]?.mainCode){const a=this.boardIds[t.bid].subCode?this.boardIds[t.bid].subCode:"none";this.$router.push("/board/articleView/"+this.boardIds[t.bid].mainCode+"/"+a+"/"+t.id)}}}else this.commentDetail(t)},commentDetail(t){if(this.boardIds[t.bid]?.mainCode){sessionStorage.setItem("viewComment",t.id);const a=this.boardIds[t.bid].subCode?this.boardIds[t.bid].subCode:"none";this.$router.push("/board/articleView/"+this.boardIds[t.bid].mainCode+"/"+a+"/"+t.parentId)}},viewSuccess(){this.page,this.category;if(this.boardIds[this.bid]?.mainCode){const t=this.boardIds[this.bid].subCode?this.boardIds[this.bid].subCode:"none";this.$router.push("/board/articleView/"+this.boardIds[this.bid].mainCode+"/"+t+"/"+this.articleId)}},pageBoardMode(t){this.searchPart(t)},searchPart(t){let a=[];for(const s in this.boardIds)a.push(s);let e={keyword:this.keywordResult,searchBids:a,code:t.addParams.code,page:t.page.toString(),limit:this.limit.toString()};this.$eventBus.$emit("overlay","open"),this.serverFlag=!0,o.Z.post(l.Am,e,(a=>{if(this.$eventBus.$emit("overlay","hide"),this.serverFlag=!1,"success"==a.status){let e=0;for(let s of this.tabList){if(s.code==t.addParams.code){s.data.total=a.resultData.total,s.data.list=a.resultData.list,s.data.paging={total:a.resultData.total,currentPage:t.page,limit:this.limit,pageGroup:10},s.data.pagingReload=!0;const i=e;setTimeout((()=>{s.data.pagingReload=!1,this.$set(this.tabList,i,s)}),500),this.$set(this.tabList,e,s)}e++}}}))}},beforeDestroy(){this.$eventBus.$off("searchKeyword")},updated(){u()(".subject em").css({color:"#C51162","font-weight":"bold","font-size":"18px","font-style":"normal"}),u()(".desc em").css({color:"#C51162","font-weight":"bold","font-style":"normal"}),u()(".keyword em").css({color:"#C51162","font-weight":"bold","font-style":"normal"})}},b=p,f=e(1001),v=e(3453),C=e.n(v),w=e(3150),y=e(6662),k=(0,f.Z)(b,s,i,!1,null,"95d80a8a",null),_=k.exports;C()(k,{VBtn:w.Z,VDialog:y.Z})}}]);
//# sourceMappingURL=7216.7613c2df.js.map